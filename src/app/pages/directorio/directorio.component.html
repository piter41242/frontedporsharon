<app-menu></app-menu>

<div class="layout">

  <div class="contenido-principal">

    <div class="header-horas d-flex justify-content-between align-items-center">

      <h3>Directorio</h3>

      <button class="btn btn-light btn-sm agregar-btn" data-bs-toggle="modal" data-bs-target="#agregarVacanteModal" (click)="abrirModalAgregar()">
        <i class="fas fa-plus-circle"></i> Agregar
      </button>

    </div>

    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover">
        <thead class="table-dark">
          <tr>
            <th>Nombre</th>
            <th>Cargo</th>
            <th>Teléfono</th>
            <th>Correo</th>
            <th>Dirección</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let vacante of vacantes; let i = index">
            <tr class="accordion-row" (click)="toggleVacante(i)" [class.expanded]="expandedVacanteIndex === i">
              <td data-label="Nombre:">{{ vacante.nombre }}</td>
              <td data-label="Cargo:">{{ vacante.cargo }}</td>
              <td data-label="Teléfono:">{{ vacante.telefono }}</td>
              <td data-label="Correo:">{{ vacante.correo }}</td>
              <td data-label="Dirección:">{{ vacante.direccion }}</td>
              <td data-label="Estado:">
                <span [class.bg-success]="vacante.estado === 'ACTIVO'"
                      [class.bg-danger]="vacante.estado === 'INACTIVO'"
                      class="badge">
                  {{ vacante.estado }}
                </span>
              </td>
              <td data-label="Acciones:" class="actions-cell">
                <button class="btn btn-link btn-acciones editar"
                        data-bs-toggle="modal"
                        data-bs-target="#editarVacanteModal"
                        title="Editar"
                        (click)="$event.stopPropagation(); editarVacante(vacante, i)">
                  <i class="fas fa-edit"></i>
                </button>

                <button class="btn btn-link btn-acciones eliminar"
                        title="Eliminar"
                        (click)="$event.stopPropagation(); confirmDelete(i)">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>

    <div class="modal fade" id="agregarVacanteModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Agregar Vacante</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form (ngSubmit)="guardarCambios()">
              <ng-container *ngTemplateOutlet="formularioVacante"></ng-container>
              <button type="submit" class="btn btn-primary">Agregar</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="editarVacanteModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Editar Vacante</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form (ngSubmit)="guardarCambios()">
              <ng-container *ngTemplateOutlet="formularioVacante"></ng-container>
              <button type="submit" class="btn btn-primary">Guardar cambios</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <ng-template #formularioVacante>
      <div class="mb-3">
        <label class="form-label">Nombre</label>
        <input class="form-control" [(ngModel)]="vacante.nombre" name="nombre" required />
      </div>
      <div class="mb-3">
        <label class="form-label">Cargo</label>
        <input class="form-control" [(ngModel)]="vacante.cargo" name="cargo" required />
      </div>
      <div class="mb-3">
        <label class="form-label">Teléfono</label>
        <input class="form-control" [(ngModel)]="vacante.telefono" name="telefono" required />
      </div>
      <div class="mb-3">
        <label class="form-label">Correo</label>
        <input class="form-control" [(ngModel)]="vacante.correo" name="correo" required />
      </div>
      <div class="mb-3">
        <label class="form-label">Dirección</label>
        <input class="form-control" [(ngModel)]="vacante.direccion" name="direccion" required />
      </div>
      <div class="mb-3">
        <label class="form-label">Estado</label>
        <select class="form-control" [(ngModel)]="vacante.estado" name="estado">
          <option value="ACTIVO">ACTIVO</option>
          <option value="INACTIVO">INACTIVO</option>
        </select>
      </div>
    </ng-template>

  </div>